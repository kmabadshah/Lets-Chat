{"version":3,"sources":["webpack:///./node_modules/@hookform/error-message/dist/index.esm.js","webpack:///./src/pages/signup.js"],"names":["o","_o","m","as","f","errors","i","name","u","message","c","render","g","r","e","s","n","a","t","Object","keys","length","indexOf","l","d","p","v","types","h","assign","children","messages","Signup","useForm","handleSubmit","setError","register","getValues","React","useContext","Context","token","setUser","onSubmit","isLoading","conf_pass","pass","type","axios","jwt","post","api","uname","headers","Authorization","res","sign","secret","err","cacheToken","localStorage","setItem","data","navigate","useEffect","console","log","id","placeholder","ref","required","style","fontSize","marginTop","color","value","to"],"mappings":"8FAAA,8DAGIA,EAAI,SAAWC,GACjB,IAAIC,EAAID,EAAGE,GACPC,EAAIH,EAAGI,OACPC,EAAIL,EAAGM,KACPC,EAAIP,EAAGQ,QACPC,EAAIT,EAAGU,OACPC,EAAI,SAAUC,EAAGC,GACnB,GAAI,MAAQD,EAAG,MAAO,GACtB,IAAIE,EACAC,EACAC,EAAI,GACJC,EAAIC,OAAOC,KAAKP,GAEpB,IAAKG,EAAI,EAAGA,EAAIE,EAAEG,OAAQL,IACxBF,EAAEQ,QAAQP,EAAIG,EAAEF,KAAO,IAAMC,EAAEF,GAAKF,EAAEE,IAGxC,OAAOE,EAXD,CAYNhB,EAAI,CAAC,KAAM,SAAU,OAAQ,UAAW,WACtCsB,EAAI,cACJC,EAAI,YAAEpB,GAAKmB,EAAElB,OAAQC,GAEzB,IAAKkB,EAAG,OAAO,KACf,IAAIC,EAAID,EAAEf,QACNiB,EAAIF,EAAEG,MACNC,EAAIT,OAAOU,OAAO,GAAIjB,EAAG,CAC3BkB,SAAUL,GAAKjB,IAEjB,OAAO,yBAAEN,GAAK,uBAAEA,EAAG0B,GAAKlB,EAAIA,EAAE,CAC5BD,QAASgB,GAAKjB,EACduB,SAAUL,IACP,wBAAExB,GAAK,WAAG0B,K,2KCoCFI,UA/Df,WAAkB,IAAD,EACmDC,cAAxDC,EADK,EACLA,aAAc7B,EADT,EACSA,OAAQ8B,EADjB,EACiBA,SAAUC,EAD3B,EAC2BA,SAD3B,KACqCC,UACZC,IAAMC,WAAWC,YAA/CC,EAFK,EAELA,MAAOC,EAFF,EAEEA,QAETC,GAJO,EAEWC,UAEV,uCAAG,WAAMpB,GAAN,mBAAAP,EAAA,yDAETO,EAAEqB,YAAcrB,EAAEsB,KAFT,gBAGTX,EAAS,YAAa,CAAEY,KAAM,SAAUtC,QAAQ,0BAHvC,uCAKW,gDALX,cAKHuC,EALG,gBAMS,gDANT,cAMHC,EANG,iBASSD,EAAME,KAAKC,IAAI,YAAa,CAC1CC,MAAO5B,EAAE4B,MAAON,KAAMtB,EAAEsB,MACzB,CAAEO,QAAS,CAAEC,cAAc,UAAWb,KAXhC,QASHc,EATG,OAaTN,EAAIO,KAAK,CAAEJ,MAAO5B,EAAE4B,OAASK,KAAQ,SAACC,EAAKC,GACvCC,aAAaC,QAAQ,QAASF,MAElCjB,EAAQa,EAAIO,MACZC,YAAS,KAjBA,4CAAH,uDAyBd,OAJAzB,IAAM0B,WAAU,WACZC,QAAQC,IAAI,YACb,IAGC,yBAAKC,GAAG,UACJ,0BAAMxB,SAAUT,EAAaS,IACzB,0CAEA,2BAAOpC,KAAK,QAAQ6D,YAAY,WAAWC,IAAKjC,EAAS,CACrDkC,UAAU,MAGd,2BAAO/D,KAAK,OAAOwC,KAAK,WAAWqB,YAAY,WAC3CC,IAAKjC,EAAS,CACVkC,UAAU,MAGlB,2BAAO/D,KAAK,YAAYwC,KAAK,WAAWqB,YAAY,mBAChDC,IAAKjC,EAAS,CACVkC,UAAU,MAElB,kBAAC,IAAD,CACIjE,OAAQA,EACRE,KAAK,YACLgE,MAAO,CAACC,SAAU,UAAWC,UAAW,UAAWC,MAAO,WAC1DvE,GAAG,MAGP,6BACI,2BAAO4C,KAAK,SAAS4B,MAAM,YAC3B,kBAAC,IAAD,CAAMC,GAAG,UAAT","file":"component---src-pages-signup-js-5b1bd99e90e47260e792.js","sourcesContent":["import { isValidElement as r, cloneElement as e, createElement as s, Fragment as n } from \"react\";\nimport { useFormContext as a, get as t } from \"react-hook-form\";\n\nvar o = function o(_o) {\n  var m = _o.as,\n      f = _o.errors,\n      i = _o.name,\n      u = _o.message,\n      c = _o.render,\n      g = function (r, e) {\n    if (null == r) return {};\n    var s,\n        n,\n        a = {},\n        t = Object.keys(r);\n\n    for (n = 0; n < t.length; n++) {\n      e.indexOf(s = t[n]) >= 0 || (a[s] = r[s]);\n    }\n\n    return a;\n  }(_o, [\"as\", \"errors\", \"name\", \"message\", \"render\"]),\n      l = a(),\n      d = t(f || l.errors, i);\n\n  if (!d) return null;\n  var p = d.message,\n      v = d.types,\n      h = Object.assign({}, g, {\n    children: p || u\n  });\n  return r(m) ? e(m, h) : c ? c({\n    message: p || u,\n    messages: v\n  }) : s(m || n, h);\n};\n\nexport { o as ErrorMessage };","import React, {useState} from \"react\"\nimport { useForm } from \"react-hook-form\"\nimport { api, secret, loader } from \"../shared/constants\"\nimport { Context } from \"../components/wrapper\"\nimport { navigate, Link } from \"gatsby\"\nimport { ErrorMessage } from '@hookform/error-message'\n\nfunction Signup(){\n    const { handleSubmit, errors, setError, register, getValues } = useForm()\n    const { token, setUser, isLoading } = React.useContext(Context)\n\n    const onSubmit = async d => {\n        // check if the passwords match\n        if (d.conf_pass !== d.pass) {\n            setError('conf_pass', { type: 'random', message: `Passwords don't match` })\n        } else {\n            const axios = await import('axios')\n            const jwt = await import('jsonwebtoken')\n\n            // send the data\n            const res = await axios.post(api+'/chatters', {\n                uname: d.uname, pass: d.pass\n            }, { headers: { Authorization: `Bearer ${token}` } })\n            // store in cache\n            jwt.sign({ uname: d.uname }, secret, (err, cacheToken) => {\n                localStorage.setItem('token', cacheToken)\n            })\n            setUser(res.data)\n            navigate('/')\n        }\n    }\n\n    React.useEffect(() => {\n        console.log('Signup')\n    }, [])\n\n    return (\n        <div id='signup'>\n            <form onSubmit={handleSubmit(onSubmit)}>\n                <h1>Let's Chat</h1>\n\n                <input name=\"uname\" placeholder=\"Username\" ref={register({\n                    required: true\n                })} />\n\n                <input name=\"pass\" type=\"password\" placeholder=\"Password\"\n                    ref={register({\n                        required: true\n                    })} />\n\n                <input name=\"conf_pass\" type=\"password\" placeholder=\"Confirm Password\"\n                    ref={register({\n                        required: true\n                    })} />\n                <ErrorMessage\n                    errors={errors}\n                    name='conf_pass'\n                    style={{fontSize: '0.75rem', marginTop: '0.25rem', color: '#EF7B6C'}}\n                    as='p'\n                />\n\n                <div>\n                    <input type=\"submit\" value=\"Sign Up\" />\n                    <Link to='/login'>Log In</Link>\n                </div>\n            </form>\n        </div>\n    )\n}\n\nexport default Signup\n"],"sourceRoot":""}
{"version":3,"sources":["webpack:///./node_modules/@hookform/error-message/dist/index.esm.js","webpack:///./src/components/layout.js","webpack:///./src/pages/add-friend.js"],"names":["o","_o","m","as","f","errors","i","name","u","message","c","render","g","r","e","s","n","a","t","Object","keys","length","indexOf","l","d","p","v","types","h","assign","children","messages","Layout","style","id","to","AddFriend","useForm","handleSubmit","reset","register","setError","React","useContext","Context","token","user","setUser","onSubmit","axios","qs","get","api","stringify","_where","uname","headers","Authorization","res","friends","find","type","shouldFocus","data","messagesSentByMe","messagesSentToMe","console","log","autoComplete","ref","required","placeholder","value"],"mappings":"6FAAA,8DAGIA,EAAI,SAAWC,GACjB,IAAIC,EAAID,EAAGE,GACPC,EAAIH,EAAGI,OACPC,EAAIL,EAAGM,KACPC,EAAIP,EAAGQ,QACPC,EAAIT,EAAGU,OACPC,EAAI,SAAUC,EAAGC,GACnB,GAAI,MAAQD,EAAG,MAAO,GACtB,IAAIE,EACAC,EACAC,EAAI,GACJC,EAAIC,OAAOC,KAAKP,GAEpB,IAAKG,EAAI,EAAGA,EAAIE,EAAEG,OAAQL,IACxBF,EAAEQ,QAAQP,EAAIG,EAAEF,KAAO,IAAMC,EAAEF,GAAKF,EAAEE,IAGxC,OAAOE,EAXD,CAYNhB,EAAI,CAAC,KAAM,SAAU,OAAQ,UAAW,WACtCsB,EAAI,cACJC,EAAI,YAAEpB,GAAKmB,EAAElB,OAAQC,GAEzB,IAAKkB,EAAG,OAAO,KACf,IAAIC,EAAID,EAAEf,QACNiB,EAAIF,EAAEG,MACNC,EAAIT,OAAOU,OAAO,GAAIjB,EAAG,CAC3BkB,SAAUL,GAAKjB,IAEjB,OAAO,yBAAEN,GAAK,uBAAEA,EAAG0B,GAAKlB,EAAIA,EAAE,CAC5BD,QAASgB,GAAKjB,EACduB,SAAUL,IACP,wBAAExB,GAAK,WAAG0B,K,kCClCjB,qCAeeI,IAZf,YAAqC,IAAnBF,EAAkB,EAAlBA,SAAUG,EAAQ,EAARA,MAC3B,OACC,yBAAKC,GAAG,SAASD,MAAOA,GACvB,yBAAKC,GAAG,UACP,kBAAC,IAAD,CAAMC,GAAG,KAAT,QACA,kBAAC,IAAD,CAAMA,GAAG,aAAT,aAECL,K,uLCsEUM,UAzEf,WAAqB,IAAD,EACwCC,cAAnDC,EADW,EACXA,aAAcC,EADH,EACGA,MAAOC,EADV,EACUA,SAAUnC,EADpB,EACoBA,OAAQoC,EAD5B,EAC4BA,SAD5B,EAEcC,IAAMC,WAAWC,WAA1CC,EAFW,EAEXA,MAAOC,EAFI,EAEJA,KAAMC,EAFF,EAEEA,QAEfC,EAAQ,uCAAG,WAAOxB,GAAP,mBAAAP,EAAA,+EAEK,gDAFL,cAETgC,EAFS,gBAGE,qCAHF,cAGTC,EAHS,gBAMGD,EAAME,IAAIC,IAAI,aAAaF,EAAGG,UAAU,CACzDC,OAAQ,CAAEC,MAAO/B,EAAE+B,SAChB,CAAEC,QAAS,CAAEC,cAAc,UAAWZ,KAR3B,OAMTa,EANS,OAWOZ,EAAKa,QAAQC,MAAK,SAAAxD,GAAC,OAAIA,EAAEmD,QAAU/B,EAAE+B,SAE1Dd,EAAS,QAAS,CACjBoB,KAAM,SAAUC,aAAa,EAC7BrD,QAAS,uCAKNiD,EAAIK,KAAK,IACZhB,EAAQ,OAAD,UACHD,EADG,CACGa,QAAQ,GAAD,mBACZb,EAAKa,SADO,CAEf,CAAEJ,MAAO/B,EAAE+B,MACVS,iBAAkB,GAClBC,iBAAkB,SAIrB1B,KAEAE,EAAS,QAAS,CACjBoB,KAAM,SAAUC,aAAa,EAC7BrD,QAAS,4BAlCG,kDAuCfgC,EAAS,QAAS,CACjBoB,KAAM,SAAUC,aAAa,EAC7BrD,QAAS,2CAEVyD,QAAQC,IAAR,MA3Ce,0DAAH,sDA+Cd,OACC,kBAAC,IAAD,KACC,yBAAKjC,GAAG,cACP,0BAAMkC,aAAa,MAAMpB,SAAUV,EAAaU,IAC/C,2BAAOzC,KAAK,QAAQ6D,aAAa,QAAQC,IAAK7B,EAAS,CACtD8B,UAAU,IACPC,YAAY,aAChB,2BAAOV,KAAK,SAASW,MAAM,WAE3B,kBAAC,IAAD,CACCnE,OAAQA,EACRE,KAAK,QACLI,OAAQ,SAACa,GACR,OAAO,2BAAIA,EAAEf","file":"component---src-pages-add-friend-js-944e26ded14465562ea2.js","sourcesContent":["import { isValidElement as r, cloneElement as e, createElement as s, Fragment as n } from \"react\";\nimport { useFormContext as a, get as t } from \"react-hook-form\";\n\nvar o = function o(_o) {\n  var m = _o.as,\n      f = _o.errors,\n      i = _o.name,\n      u = _o.message,\n      c = _o.render,\n      g = function (r, e) {\n    if (null == r) return {};\n    var s,\n        n,\n        a = {},\n        t = Object.keys(r);\n\n    for (n = 0; n < t.length; n++) {\n      e.indexOf(s = t[n]) >= 0 || (a[s] = r[s]);\n    }\n\n    return a;\n  }(_o, [\"as\", \"errors\", \"name\", \"message\", \"render\"]),\n      l = a(),\n      d = t(f || l.errors, i);\n\n  if (!d) return null;\n  var p = d.message,\n      v = d.types,\n      h = Object.assign({}, g, {\n    children: p || u\n  });\n  return r(m) ? e(m, h) : c ? c({\n    message: p || u,\n    messages: v\n  }) : s(m || n, h);\n};\n\nexport { o as ErrorMessage };","import React, {useState} from 'react'\nimport { Link } from 'gatsby'\n\nfunction Layout({ children, style }){\n\treturn(\n\t\t<div id='layout' style={style}>\n\t\t\t<div id='navbar'>\n\t\t\t\t<Link to='/'>Home</Link>\n\t\t\t\t<Link to='/settings'>Settings</Link>\n\t\t\t</div>\n\t\t\t{ children }\n\t\t</div>\n\t)\n}\n\nexport default Layout\n","import React, {useState} from \"react\"\nimport Layout from '../components/layout'\nimport { useForm } from 'react-hook-form'\nimport { ErrorMessage  } from '@hookform/error-message'\nimport { Context } from '../components/wrapper'\nimport { api } from '../shared/constants'\n\nfunction AddFriend(){\n\tconst { handleSubmit, reset, register, errors, setError} = useForm()\n\tconst { token, user, setUser } = React.useContext(Context)\n\n\tconst onSubmit = async (d) => {\n\t\ttry {\n\t\t\tconst axios = await import('axios')\n\t\t\tconst qs = await import('qs')\n\n\t\t\t// check if the person exists\n\t\t\tconst res = await axios.get(api+'/chatters?'+qs.stringify({\n\t\t\t\t_where: { uname: d.uname }\n\t\t\t}), { headers: { Authorization: `Bearer ${token}` } })\n\n\t\t\t// check if already friend\n\t\t\tconst alreadyFriend = user.friends.find(f => f.uname === d.uname)\n\t\t\tif (alreadyFriend) {\n\t\t\t\tsetError('uname', {\n\t\t\t\t\ttype: 'random', shouldFocus: true,\n\t\t\t\t\tmessage: 'That person is already your friend'\n\t\t\t\t})\n\t\t\t} else {\n\n\t\t\t\t// update the local user state, which will automagically send the data to db\n\t\t\t\tif (res.data[0]) {\n\t\t\t\t\tsetUser({\n\t\t\t\t\t\t...user, friends: [\n\t\t\t\t\t\t\t...user.friends,\n\t\t\t\t\t\t\t{ uname: d.uname,\n\t\t\t\t\t\t\t\tmessagesSentByMe: [],\n\t\t\t\t\t\t\t\tmessagesSentToMe: []\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]})\n\n\t\t\t\t\treset() // clear everything out\n\t\t\t\t} else {\n\t\t\t\t\tsetError('uname', {\n\t\t\t\t\t\ttype: 'random', shouldFocus: true,\n\t\t\t\t\t\tmessage: \"That user doesn't exist\"\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t}\n\t\t} catch (err) {\n\t\t\tsetError('uname', {\n\t\t\t\ttype: 'random', shouldFocus: true,\n\t\t\t\tmessage: 'Something went wrong, please try again'\n\t\t\t})\n\t\t\tconsole.log(err)\n\t\t}\n\t}\n\n\treturn(\n\t\t<Layout>\n\t\t\t<div id='add-friend'>\n\t\t\t\t<form autoComplete='off' onSubmit={handleSubmit(onSubmit)}>\n\t\t\t\t\t<input name='uname' autoComplete='false' ref={register({\n\t\t\t\t\t\trequired: true\n\t\t\t\t\t})} placeholder='John Doe' />\n\t\t\t\t\t<input type=\"submit\" value=\"Submit\" />\n\n\t\t\t\t\t<ErrorMessage\n\t\t\t\t\t\terrors={errors}\n\t\t\t\t\t\tname='uname'\n\t\t\t\t\t\trender={(d) => {\n\t\t\t\t\t\t\treturn <p>{d.message}</p>\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</Layout>\n\t)\n}\n\nexport default AddFriend\n\n"],"sourceRoot":""}